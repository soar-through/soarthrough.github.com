import{g as Ee}from"./data-Dt2PaoNa.js";var Gt=function(t){return zt(t)&&!Dt(t)};function zt(e){return!!e&&typeof e=="object"}function Dt(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Kt(e)}var qt=typeof Symbol=="function"&&Symbol.for,Vt=qt?Symbol.for("react.element"):60103;function Kt(e){return e.$$typeof===Vt}function Bt(e){return Array.isArray(e)?[]:{}}function X(e,t){return t.clone!==!1&&t.isMergeableObject(e)?U(Bt(e),e,t):e}function Jt(e,t,r){return e.concat(t).map(function(n){return X(n,r)})}function Yt(e,t){if(!t.customMerge)return U;var r=t.customMerge(e);return typeof r=="function"?r:U}function Ht(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function Te(e){return Object.keys(e).concat(Ht(e))}function tt(e,t){try{return t in e}catch{return!1}}function Qt(e,t){return tt(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function Wt(e,t,r){var n={};return r.isMergeableObject(e)&&Te(e).forEach(function(s){n[s]=X(e[s],r)}),Te(t).forEach(function(s){Qt(e,s)||(tt(e,s)&&r.isMergeableObject(t[s])?n[s]=Yt(s,r)(e[s],t[s],r):n[s]=X(t[s],r))}),n}function U(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||Jt,r.isMergeableObject=r.isMergeableObject||Gt,r.cloneUnlessOtherwiseSpecified=X;var n=Array.isArray(t),s=Array.isArray(e),i=n===s;return i?n?r.arrayMerge(e,t,r):Wt(e,t,r):X(t,r)}U.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,s){return U(n,s,r)},{})};var Xt=U,Zt=Xt;const Pi=Ee(Zt);class L extends Error{}const er=2147483647,tr=-2147483648,rr=Number.MAX_SAFE_INTEGER,nr=Number.MIN_SAFE_INTEGER,k=Symbol("missing"),rt=Object.freeze(new Error("mingo: cycle detected while processing object/array")),sr="[object Object]",ir=/^\[object ([a-zA-Z0-9]+)\]$/,ie=e=>{const t=lr(e);let r=0,n=t.length;for(;n;)r=(r<<5)-r^t.charCodeAt(--n);return r>>>0},nt=new Set(["null","undefined","boolean","number","string","date","regexp"]),or={null:0,undefined:0,number:1,string:2,object:3,array:4,boolean:5,date:6,regexp:7,function:8},S=(e,t)=>{e===k&&(e=void 0),t===k&&(t=void 0);const[r,n]=[e,t].map(s=>or[Z(s).toLowerCase()]);return r!==n?r-n:r===1||r===2||r===6?e<t?-1:e>t?1:0:I(e,t)?0:e<t?-1:e>t?1:0};function O(e,t){if(!e)throw new L(t)}const Z=e=>ir.exec(Object.prototype.toString.call(e))[1],fe=e=>typeof e=="boolean",v=e=>typeof e=="string",A=e=>!isNaN(e)&&typeof e=="number",m=Array.isArray,d=e=>{if(!e)return!1;const t=Object.getPrototypeOf(e);return(t===Object.prototype||t===null)&&sr===Object.prototype.toString.call(e)},oe=e=>e===Object(e),pe=e=>e instanceof Date,W=e=>e instanceof RegExp,Ae=e=>typeof e=="function",p=e=>e==null,G=(e,t)=>e.includes(t),st=(e,t)=>!G(e,t),z=(e,t=!0)=>!!e||t&&e==="",q=e=>p(e)||v(e)&&!e||e instanceof Array&&e.length===0||d(e)&&Object.keys(e).length===0,Me=e=>e===k,V=e=>e instanceof Array?e:[e],x=(e,t)=>!!e&&Object.prototype.hasOwnProperty.call(e,t),xe=e=>typeof ArrayBuffer<"u"&&ArrayBuffer.isView(e),cr=[pe,W,xe],ye=(e,t)=>{if(p(e))return e;if(t.has(e))throw rt;const r=e.constructor;if(cr.some(n=>n(e)))return new r(e);try{if(t.add(e),m(e))return e.map(n=>ye(n,t));if(d(e)){const n={};for(const s in e)n[s]=ye(e[s],t);return n}}finally{t.delete(e)}return e},Pe=e=>ye(e,new Set),ar=(e,t)=>d(e)&&d(t)||m(e)&&m(t);function me(e,t,r){if(r=r||{flatten:!1},Me(e)||p(e))return t;if(Me(t)||p(t))return e;if(!ar(e,t)){if(r.skipValidation)return t||e;throw Error("mismatched types. must both be array or object")}if(r.skipValidation=!0,m(e)){const n=e,s=t;if(r.flatten){let i=0,o=0;for(;i<n.length&&o<s.length;)n[i]=me(n[i++],s[o++],r);for(;o<s.length;)n.push(t[o++])}else ee(n,s)}else for(const n in t)e[n]=me(e[n],t[n],r);return e}function Re(e,t=ie){const r=new Map;return e.forEach((n,s)=>{const i=ct(n,t);r.has(i)?r.get(i).some(o=>I(e[o],n))||r.get(i).push(s):r.set(i,[s])}),r}function it(e,t=ie){if(e.some(c=>c.length==0))return[];if(e.length===1)return Array.from(e);const r=fr(e.map((c,a)=>[a,c.length]),c=>c[1]),n=e[r[0][0]],s=Re(n,t),i=new Map,o=new Array;return s.forEach((c,a)=>{const u=c.map(f=>n[f]),l=u.map(f=>0),h=u.map(f=>[r[0][0],0]);let w=!1;for(let f=1;f<e.length;f++){const[g,b]=r[f],F=e[g];if(i.has(f)||i.set(f,Re(F)),i.get(f).has(a)){const E=i.get(f).get(a).map(J=>F[J]);w=u.map((J,Y)=>E.some((Lt,Ft)=>{const Ut=l[Y];return I(J,Lt)&&(l[Y]++,g<h[Y][0]&&(h[Y]=[g,i.get(f).get(a)[Ft]])),Ut<l[Y]})).some(Boolean)}if(!w)return}w&&ee(o,l.map((f,g)=>f===e.length-1?[u[g],h[g]]:k).filter(f=>f!==k))}),o.sort((c,a)=>{const[u,[l,h]]=c,[w,[f,g]]=a,b=S(l,f);return b!==0?b:S(h,g)}).map(c=>c[0])}function ot(e,t=0){const r=new Array;function n(s,i){for(let o=0,c=s.length;o<c;o++)m(s[o])&&(i>0||i<0)?n(s[o],Math.max(-1,i-1)):r.push(s[o])}return n(e,t),r}const ur=e=>{let[t,r]=[Object.getPrototypeOf(e),Object.getOwnPropertyNames(e)],n=t;for(;!r.length&&t!==Object.prototype&&t!==Array.prototype;)n=t,r=Object.getOwnPropertyNames(t),t=Object.getPrototypeOf(t);const s={};return r.forEach(i=>s[i]=e[i]),[s,n]};function I(e,t){if(e===t||Object.is(e,t))return!0;const r=!!e&&e.constructor||e;if(e===null||t===null||e===void 0||t===void 0||r!==t.constructor||r===Function)return!1;if(r===Array||r===Object){const i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length||new Set([...i,...o]).size!=i.length)return!1;for(const c of i)if(!I(e[c],t[c]))return!1;return!0}const n=Object.getPrototypeOf(e);return(xe(e)||n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))&&e.toString()===t.toString()}const re=(e,t)=>{if(e===null)return"null";if(e===void 0)return"undefined";const r=e.constructor;switch(r){case RegExp:case Number:case Boolean:case Function:case Symbol:return e.toString();case String:return JSON.stringify(e);case Date:return e.toISOString()}if(xe(e))return r.name+"["+e.toString()+"]";if(t.has(e))throw rt;try{if(t.add(e),m(e))return"["+e.map(o=>re(o,t)).join(",")+"]";if(r===Object)return"{"+Object.keys(e).sort().map(o=>o+":"+re(e[o],t)).join(",")+"}";const n=Object.getPrototypeOf(e);if(n!==Object.prototype&&n!==Array.prototype&&Object.prototype.hasOwnProperty.call(n,"toString"))return r.name+"("+JSON.stringify(e.toString())+")";const[s,i]=ur(e);return r.name+re(s,t)}finally{t.delete(e)}},lr=e=>re(e,new Set);function ct(e,t){return t=t||ie,p(e)?null:t(e).toString()}function fr(e,t,r=S){if(q(e))return e;const n=new Array,s=new Array;for(let i=0;i<e.length;i++){const o=e[i],c=t(o,i);p(c)?s.push(o):n.push([c,o])}return n.sort((i,o)=>r(i[0],o[0])),ee(s,n.map(i=>i[1]))}function hr(e,t,r=ie){if(e.length<1)return new Map;const n=new Map,s=new Map;for(let i=0;i<e.length;i++){const o=e[i],c=t(o,i),a=ct(c,r);if(a===null)s.has(null)?s.get(null).push(o):s.set(null,[o]);else{const u=n.has(a)?n.get(a).find(l=>I(l,c)):null;p(u)?(s.set(c,[o]),n.has(a)?n.get(a).push(c):n.set(a,[c])):s.get(u).push(o)}}return s}const he=5e4;function ee(e,...t){return e instanceof Array?t.reduce((r,n)=>{let s=Math.ceil(n.length/he),i=0;for(;s-- >0;)Array.prototype.push.apply(r,n.slice(i,i+he)),i+=he;return r},e):t.filter(oe).reduce((r,n)=>(Object.assign(r,n),r),e)}function Oe(e,t){return oe(e)?e[t]:void 0}function dr(e,t){if(t<1)return e;for(;t--&&e.length===1;)e=e[0];return e}function te(e,t,r){let n=0;function s(o,c){let a=o;for(let u=0;u<c.length;u++){const l=c[u];if(/^\d+$/.exec(l)===null&&a instanceof Array){if(u===0&&n>0)break;n+=1;const w=c.slice(u);a=a.reduce((f,g)=>{const b=s(g,w);return b!==void 0&&f.push(b),f},[]);break}else a=Oe(a,l);if(a===void 0)break}return a}const i=nt.has(Z(e).toLowerCase())?e:s(e,t.split("."));return i instanceof Array&&(r!=null&&r.unwrapArray)?dr(i,n):i}function ne(e,t,r){const n=t.split("."),s=n[0],i=n.slice(1).join("."),o=/^\d+$/.exec(s)!==null,c=n.length>1;let a,u;if(e instanceof Array)if(o)a=Oe(e,Number(s)),c&&(a=ne(a,i,r)),a=[a];else{a=[];for(const l of e)u=ne(l,t,r),r!=null&&r.preserveMissing?(u===void 0&&(u=k),a.push(u)):u!==void 0&&a.push(u)}else{if(u=Oe(e,s),c&&(u=ne(u,i,r)),u===void 0)return;a=r!=null&&r.preserveKeys?{...e}:{},a[s]=u}return a}function $e(e){if(e instanceof Array)for(let t=e.length-1;t>=0;t--)e[t]===k?e.splice(t,1):$e(e[t]);else if(d(e))for(const t in e)x(e,t)&&$e(e[t])}const Ce=/^\d+$/;function se(e,t,r,n){const s=t.split("."),i=s[0],o=s.slice(1).join(".");if(s.length===1)(d(e)||m(e)&&Ce.test(i))&&r(e,i);else{n!=null&&n.buildGraph&&p(e[i])&&(e[i]={});const c=e[i];if(!c)return;const a=!!(s.length>1&&Ce.test(s[1]));c instanceof Array&&(n!=null&&n.descendArray)&&!a?c.forEach(u=>se(u,o,r,n)):se(c,o,r,n)}}function gr(e,t,r){se(e,t,(n,s)=>{n[s]=Ae(r)?r(n[s]):r},{buildGraph:!0})}function ke(e,t,r){se(e,t,(n,s)=>{if(n instanceof Array){if(/^\d+$/.test(s))n.splice(parseInt(s),1);else if(r&&r.descendArray)for(const i of n)d(i)&&delete i[s]}else d(n)&&delete n[s]},r)}const pr=/^\$[a-zA-Z0-9_]+$/;function K(e){return pr.test(e)}function at(e){if(nt.has(Z(e).toLowerCase()))return W(e)?{$regex:e}:{$eq:e};if(oe(e)){if(!Object.keys(e).some(K))return{$eq:e};if(x(e,"$regex")){const r={...e};return r.$regex=new RegExp(e.$regex,e.$options),delete r.$options,r}}return e}var Q=(e=>(e.CLONE_ALL="CLONE_ALL",e.CLONE_INPUT="CLONE_INPUT",e.CLONE_OUTPUT="CLONE_OUTPUT",e.CLONE_OFF="CLONE_OFF",e))(Q||{});class P{constructor(t,r,n,s=Date.now()){this._opts=t,this._root=r,this._local=n,this.timestamp=s,this.update(r,n)}static init(t,r,n){return t instanceof P?new P(t._opts,p(t.root)?r:t.root,Object.assign({},t.local,n)):new P(t,r,n)}update(t,r){var n;return this._root=t,this._local=r&&Object.assign({},r,{variables:Object.assign({},(n=this._local)==null?void 0:n.variables,r==null?void 0:r.variables)}),this}getOptions(){return Object.freeze({...this._opts,context:j.from(this._opts.context)})}get root(){return this._root}get local(){return this._local}get idKey(){return this._opts.idKey}get collation(){var t;return(t=this._opts)==null?void 0:t.collation}get processingMode(){var t;return((t=this._opts)==null?void 0:t.processingMode)||"CLONE_OFF"}get useStrictMode(){var t;return(t=this._opts)==null?void 0:t.useStrictMode}get scriptEnabled(){var t;return(t=this._opts)==null?void 0:t.scriptEnabled}get useGlobalContext(){var t;return(t=this._opts)==null?void 0:t.useGlobalContext}get hashFunction(){var t;return(t=this._opts)==null?void 0:t.hashFunction}get collectionResolver(){var t;return(t=this._opts)==null?void 0:t.collectionResolver}get jsonSchemaValidator(){var t;return(t=this._opts)==null?void 0:t.jsonSchemaValidator}get variables(){var t;return(t=this._opts)==null?void 0:t.variables}get context(){var t;return(t=this._opts)==null?void 0:t.context}}function ut(e){return e instanceof P?e.getOptions():Object.freeze({idKey:"_id",scriptEnabled:!0,useStrictMode:!0,useGlobalContext:!0,processingMode:"CLONE_OFF",...e,context:e!=null&&e.context?j.from(e==null?void 0:e.context):j.init({})})}var N=(e=>(e.ACCUMULATOR="accumulator",e.EXPRESSION="expression",e.PIPELINE="pipeline",e.PROJECTION="projection",e.QUERY="query",e.WINDOW="window",e))(N||{});class j{constructor(t){this.operators={accumulator:{},expression:{},pipeline:{},projection:{},query:{},window:{}};for(const[r,n]of Object.entries(t))this.addOperators(r,n)}static init(t={}){return new j(t)}static from(t){return new j(t.operators)}addOperators(t,r){for(const[n,s]of Object.entries(r))this.getOperator(t,n)||(this.operators[t][n]=s);return this}addAccumulatorOps(t){return this.addOperators("accumulator",t)}addExpressionOps(t){return this.addOperators("expression",t)}addQueryOps(t){return this.addOperators("query",t)}addPipelineOps(t){return this.addOperators("pipeline",t)}addProjectionOps(t){return this.addOperators("projection",t)}addWindowOps(t){return this.addOperators("window",t)}getOperator(t,r){return t in this.operators&&this.operators[t][r]||null}}const M=j.init();function ce(e,t){for(const[r,n]of Object.entries(t)){O(Ae(n)&&K(r),`'${r}' is not a valid operator`);const s=R(e,r,null);O(!s||n===s,`${r} already exists for '${e}' operators. Cannot change operator function once registered.`)}switch(e){case"accumulator":M.addAccumulatorOps(t);break;case"expression":M.addExpressionOps(t);break;case"pipeline":M.addPipelineOps(t);break;case"projection":M.addProjectionOps(t);break;case"query":M.addQueryOps(t);break;case"window":M.addWindowOps(t);break}}function R(e,t,r){const{context:n,useGlobalContext:s}=r||{},i=n?n.getOperator(e,t):null;return!i&&s?M.getOperator(e,t):i}const Le={$$ROOT(e,t,r){return r.root},$$CURRENT(e,t,r){return e},$$REMOVE(e,t,r){},$$NOW(e,t,r){return new Date(r.timestamp)}},be={$$KEEP(e,t,r){return e},$$PRUNE(e,t,r){},$$DESCEND(e,t,r){if(!x(t,"$cond"))return e;let n;for(const[s,i]of Object.entries(e))if(oe(i)){if(i instanceof Array){const o=[];for(let c of i)d(c)&&(c=Fe(c,t,r.update(c))),p(c)||o.push(c);n=o}else n=Fe(i,t,r.update(i));p(n)?delete e[s]:e[s]=n}return e}};function y(e,t,r,n){var i;const s=P.init(n,e);if(r=r||"",K(r)){const o=R("expression",r,n);if(o)return o(e,t,s);const c=R("accumulator",r,n);if(c)return e instanceof Array||(e=y(e,t,null,s),t=null),O(e instanceof Array,`'${r}' target must be an array.`),c(e,t,s.update(null,s.local));throw new L(`operator '${r}' is not registered`)}if(v(t)&&t.length>0&&t[0]==="$"){if(x(be,t))return t;let o=s.root;const c=t.split(".");if(x(Le,c[0]))o=Le[c[0]](e,null,s),t=t.slice(c[0].length+1);else if(c[0].slice(0,2)==="$$"){o=Object.assign({},s.variables,{this:e},(i=s.local)==null?void 0:i.variables);const a=c[0].slice(2);O(x(o,a),`Use of undefined variable: ${a}`),t=t.slice(2)}else t=t.slice(1);return t===""?o:te(o,t)}if(m(t))return t.map(o=>y(e,o,null,s));if(d(t)){const o={};for(const[c,a]of Object.entries(t))if(o[c]=y(e,a,c,s),["expression","accumulator"].some(u=>!!R(u,c,n)))return O(Object.keys(t).length===1,"Invalid aggregation expression '"+JSON.stringify(t)+"'"),o[c];return o}return t}function Fe(e,t,r){const n=y(e,t,null,r);return x(be,n)?be[n](e,t,r):n}const yr=(e,t,r)=>{const n=y(e,t,null,r);return z(n,r.useStrictMode)&&n.every(s=>z(s,r.useStrictMode))},mr=(e,t,r)=>{const n=V(t);if(n.length==0)return!1;if(n.length==1)return!y(e,n[0],null,r);throw"Expression $not takes exactly 1 argument"},Or=(e,t,r)=>{const n=y(e,t,null,r),s=r.useStrictMode;return z(n,s)&&n.some(i=>z(i,s))},lt=Object.freeze(Object.defineProperty({__proto__:null,$and:yr,$not:mr,$or:Or},Symbol.toStringTag,{value:"Module"})),$r=(e,t,r)=>{const n=y(e,t,null,r);return n[0]>n[1]?1:n[0]<n[1]?-1:0};function D(e){return e instanceof Ue?e:new Ue(e)}function br(...e){let t=0;return D(()=>{for(;t<e.length;){const r=e[t].next();if(!r.done)return r;t++}return{done:!0}})}function _r(e){return!!e&&typeof e=="object"&&(e==null?void 0:e.next)instanceof Function}function wr(e,t){const r=e.slice(t+1);e.splice(t),Array.prototype.push.apply(e,r)}const _e=new Error;function Sr(e,t,r){let n=!1,s=-1,i=0;return function(o){try{e:for(;!n;){let c=e();s++;let a=-1;const u=t.length;let l=!1;for(;++a<u;){const h=t[a];switch(h.action){case 0:c=h.func(c,s);break;case 1:if(!h.func(c,s))continue e;break;case 2:--h.count,h.count||(l=!0);break;case 3:--h.count,h.count||wr(t,a);continue e;default:break e}}if(n=l,o)r[i++]=c;else return{value:c,done:!1}}}catch(c){if(c!==_e)throw c}return n=!0,{done:n}}}class Ue{constructor(t){this.iteratees=[],this.yieldedValues=[],this.isDone=!1;let r;if(t instanceof Function&&(t={next:t}),_r(t)){const n=t;r=()=>{const s=n.next();if(s.done)throw _e;return s.value}}else if(t instanceof Array){const n=t,s=n.length;let i=0;r=()=>{if(i<s)return n[i++];throw _e}}else if(!(t instanceof Function))throw new L("Lazy must be initialized with an array, generator, or function.");this.getNext=Sr(r,this.iteratees,this.yieldedValues)}push(t,r){return typeof r=="function"?this.iteratees.push({action:t,func:r}):typeof r=="number"&&this.iteratees.push({action:t,count:r}),this}next(){return this.getNext()}map(t){return this.push(0,t)}filter(t){return this.push(1,t)}take(t){return t>0?this.push(2,t):this}drop(t){return t>0?this.push(3,t):this}transform(t){const r=this;let n;return D(()=>(n||(n=D(t(r.value()))),n.next()))}value(){return this.isDone||(this.isDone=this.getNext(!0).done),this.yieldedValues}each(t){for(;;){const r=this.next();if(r.done)break;if(t(r.value)===!1)return!1}return!0}reduce(t,r){let n=this.next();for(r===void 0&&!n.done&&(r=n.value,n=this.next());!n.done;)r=t(r,n.value),n=this.next();return r}size(){return this.reduce((t,r)=>++t,0)}[Symbol.iterator](){return this}}class Ie{constructor(t,r){this.pipeline=t,this.options=ut(r)}stream(t){let r=D(t);const n=this.options.processingMode;(n==Q.CLONE_ALL||n==Q.CLONE_INPUT)&&r.map(Pe);const s=new Array;if(!q(this.pipeline))for(const i of this.pipeline){const o=Object.keys(i),c=o[0],a=R(N.PIPELINE,c,this.options);O(o.length===1&&!!a,`invalid pipeline operator ${c}`),s.push(c),r=a(r,i[c],this.options)}return(n==Q.CLONE_OUTPUT||n==Q.CLONE_ALL&&it([["$group","$unwind"],s]).length)&&r.map(Pe),r}run(t){return this.stream(t).value()}}class vr{constructor(t,r,n,s){this.source=t,this.predicate=r,this.projection=n,this.options=s,this.operators=[],this.result=null,this.buffer=[]}fetch(){return this.result?this.result:(d(this.projection)&&this.operators.push({$project:this.projection}),this.result=D(this.source).filter(this.predicate),this.operators.length>0&&(this.result=new Ie(this.operators,this.options).stream(this.result)),this.result)}fetchAll(){const t=D([...this.buffer]);return this.buffer=[],br(t,this.fetch())}all(){return this.fetchAll().value()}count(){return this.all().length}skip(t){return this.operators.push({$skip:t}),this}limit(t){return this.operators.push({$limit:t}),this}sort(t){return this.operators.push({$sort:t}),this}collation(t){return this.options={...this.options,collation:t},this}next(){if(this.buffer.length>0)return this.buffer.pop();const t=this.fetch().next();if(!t.done)return t.value}hasNext(){if(this.buffer.length>0)return!0;const t=this.fetch().next();return t.done?!1:(this.buffer.push(t.value),!0)}map(t){return this.all().map(t)}forEach(t){this.all().forEach(t)}[Symbol.iterator](){return this.fetchAll()}}class T{constructor(t,r){this.condition=t,this.options=ut(r),this.compiled=[],this.compile()}compile(){O(d(this.condition),`query criteria must be an object: ${JSON.stringify(this.condition)}`);const t={};for(const[r,n]of Object.entries(this.condition)){if(r==="$where")Object.assign(t,{field:r,expr:n});else if(G(["$and","$or","$nor","$expr","$jsonSchema"],r))this.processOperator(r,r,n);else{O(!K(r),`unknown top level operator: ${r}`);for(const[s,i]of Object.entries(at(n)))this.processOperator(r,s,i)}t.field&&this.processOperator(t.field,t.field,t.expr)}}processOperator(t,r,n){const s=R(N.QUERY,r,this.options);if(!s)throw new L(`unknown query operator ${r}`);const i=s(t,n,this.options);this.compiled.push(i)}test(t){for(let r=0,n=this.compiled.length;r<n;r++)if(!this.compiled[r](t))return!1;return!0}find(t,r){return new vr(t,n=>this.test(n),r||{},this.options)}remove(t){return t.reduce((r,n)=>(this.test(n)||r.push(n),r),[])}}function $(e){const t=(r,n,s)=>{const i={unwrapArray:!0},o=Math.max(1,r.split(".").length-1);return c=>{const a=te(c,r,i);return e(a,n,{...s,depth:o})}};return t.op="query",t}function B(e){return(t,r,n)=>{const s=y(t,r,null,n);return e(...s)}}function je(e,t,r){if(I(e,t)||p(e)&&p(t))return!0;if(e instanceof Array){const n=I.bind(null,t);return e.some(n)||ot(e,r==null?void 0:r.depth).some(n)}return!1}function ft(e,t,r){return!je(e,t,r)}function ht(e,t,r){return p(e)?t.some(n=>n===null):it([V(e),t],r==null?void 0:r.hashFunction).length>0}function Er(e,t,r){return!ht(e,t,r)}function dt(e,t,r){return ae(e,t,(n,s)=>S(n,s)<0)}function gt(e,t,r){return ae(e,t,(n,s)=>S(n,s)<=0)}function pt(e,t,r){return ae(e,t,(n,s)=>S(n,s)>0)}function yt(e,t,r){return ae(e,t,(n,s)=>S(n,s)>=0)}function Ar(e,t,r){return V(e).some(n=>t.length===2&&n%t[0]===t[1])}function xr(e,t,r){const n=V(e),s=i=>v(i)&&z(t.exec(i),r==null?void 0:r.useStrictMode);return n.some(s)||ot(n,1).some(s)}function Ir(e,t,r){return(t===!1||t===0)&&e===void 0||(t===!0||t===1)&&e!==void 0}function jr(e,t,r){if(!m(e)||!m(t)||!e.length||!t.length)return!1;let n=!0;for(const s of t){if(!n)break;d(s)&&G(Object.keys(s),"$elemMatch")?n=mt(e,s.$elemMatch,r):s instanceof RegExp?n=e.some(i=>typeof i=="string"&&s.test(i)):n=e.some(i=>I(s,i))}return n}function Nr(e,t,r){return Array.isArray(e)&&e.length===t}function Tr(e){return K(e)&&["$and","$or","$nor"].indexOf(e)===-1}function mt(e,t,r){if(m(e)&&!q(e)){let n=o=>o,s=t;Object.keys(t).every(Tr)&&(s={temp:t},n=o=>({temp:o}));const i=new T(s,r);for(let o=0,c=e.length;o<c;o++)if(i.test(n(e[o])))return!0}return!1}const Ge=e=>e===null,ze=e=>A(e)&&e>=tr&&e<=er&&e.toString().indexOf(".")===-1,De=e=>A(e)&&e>=nr&&e<=rr&&e.toString().indexOf(".")===-1,Mr={array:m,bool:fe,boolean:fe,date:pe,decimal:A,double:A,int:ze,long:De,number:A,null:Ge,object:d,regex:W,regexp:W,string:v,undefined:p,function:e=>{throw new L("unsupported type key `function`.")},1:A,2:v,3:d,4:m,6:p,8:fe,9:pe,10:Ge,11:W,16:ze,18:De,19:A};function qe(e,t,r){const n=Mr[t];return n?n(e):!1}function Pr(e,t,r){return Array.isArray(t)?t.findIndex(n=>qe(e,n))>=0:qe(e,t)}function ae(e,t,r){return V(e).some(n=>Z(n)===Z(t)&&r(n,t))}const Rr=B(je),Cr=B(pt),kr=B(yt),Lr=B(dt),Fr=B(gt),Ur=B(ft),Ot=Object.freeze(Object.defineProperty({__proto__:null,$cmp:$r,$eq:Rr,$gt:Cr,$gte:kr,$lt:Lr,$lte:Fr,$ne:Ur},Symbol.toStringTag,{value:"Module"})),$t=(e,t,r)=>{if(q(t)||!d(t))return e;let n=S;const s=r.collation;return d(s)&&v(s.locale)&&(n=zr(s)),e.transform(i=>{const o=Object.keys(t);for(const c of o.reverse()){const a=hr(i,l=>te(l,c),r.hashFunction),u=Array.from(a.keys()).sort(n);t[c]===-1&&u.reverse(),i=[],u.reduce((l,h)=>ee(l,a.get(h)),i)}return i})},Gr={1:"base",2:"accent",3:"variant"};function zr(e){const t={sensitivity:Gr[e.strength||3],caseFirst:e.caseFirst==="off"?"false":e.caseFirst||"false",numeric:e.numericOrdering||!1,ignorePunctuation:e.alternate==="shifted"};(e.caseLevel||!1)===!0&&(t.sensitivity==="base"&&(t.sensitivity="case"),t.sensitivity==="accent"&&(t.sensitivity="variant"));const r=new Intl.Collator(e.locale,t);return(n,s)=>{if(!v(n)||!v(s))return S(n,s);const i=r.compare(n,s);return i<0?-1:i>0?1:0}}const bt=(e,t,r)=>e.take(t),Dr=(e,t,r)=>{const n=y(e,t,null,r),s=n[0];let i=n[1],o=n[2];return p(o)?i<0?(i=Math.max(0,s.length+i),o=s.length-i+1):(o=i,i=0):(i<0&&(i=Math.max(0,s.length+i)),O(o>0,"Invalid argument for $slice operator. Limit must be a positive number"),o+=i),s.slice(i,o)},Ve=(e,t)=>{const r={};return e.split("").forEach((n,s)=>r[n]=t*(s+1)),r};({...Ve("ABCDEFGHIKLM",1),...Ve("NOPQRSTUVWXY",-1)});const Ke={undefined:null,null:null,NaN:NaN,Infinity:new Error,"-Infinity":new Error};function _(e,t=Ke){const r=Object.assign({},Ke,t),n=new Set(Object.keys(r));return(s,i,o)=>{const c=y(s,i,null,o);if(n.has(`${c}`)){const a=r[`${c}`];if(a instanceof Error)throw new L(`cannot apply $${e.name} to -inf, value must in (-inf,inf)`);return a}return e(c)}}_(Math.acos,{Infinity:1/0,0:new Error});_(Math.acosh,{Infinity:1/0,0:new Error});_(Math.asin);_(Math.asinh,{Infinity:1/0,"-Infinity":-1/0});_(Math.atan);_(Math.atanh,{1:1/0,"-1":-1/0});_(Math.cos);_(Math.cosh,{"-Infinity":1/0,Infinity:1/0});const qr=Math.PI/180;_(e=>e*qr,{Infinity:1/0,"-Infinity":1/0});const Vr=180/Math.PI;_(e=>e*Vr,{Infinity:1/0,"-Infinity":-1/0});_(Math.sin);_(Math.sinh,{"-Infinity":-1/0,Infinity:1/0});_(Math.tan);const _t=(e,t,r)=>{if(q(t))return e;let n=Object.keys(t),s=!1;wt(t,r);const i=r.idKey;if(G(n,i)){const c=t[i];(c===0||c===!1)&&(n=n.filter(st.bind(null,[i])),s=n.length==0)}else n.push(i);const o=P.init(r);return e.map(c=>we(c,t,o.update(c),n,s))};function we(e,t,r,n,s){let i={},o=!1,c=!1;const a=[];s&&a.push(r.idKey);for(const u of n){let l;const h=t[u];if(u!==r.idKey&&G([0,!1],h)&&(c=!0),u===r.idKey&&q(h))l=e[u];else if(v(h))l=y(e,h,u,r);else if(!G([1,!0],h))if(h instanceof Array)l=h.map(f=>{const g=y(e,f,null,r);return p(g)?null:g});else if(d(h)){const f=h,g=Object.keys(h),b=g.length==1?g[0]:"",F=R(N.PROJECTION,b,r);if(F)b==="$slice"?V(f[b]).every(A)?(l=F(e,f[b],u,r),o=!0):l=y(e,f,u,r):l=F(e,f[b],u,r);else if(K(b))l=y(e,f[b],b,r);else if(x(e,u)){wt(f,r);let E=e[u];E instanceof Array?l=E.map(J=>we(J,f,r,g,!1)):(E=d(E)?E:e,l=we(E,f,r,g,!1))}else l=y(e,h,null,r)}else{a.push(u);continue}const w=ne(e,u,{preserveMissing:!0});w!==void 0&&me(i,w,{flatten:!0}),st([0,1,!1,!0],h)&&(l===void 0?ke(i,u,{descendArray:!0}):gr(i,u,l))}if($e(i),(o||c||s)&&(i=ee({},e,i),a.length>0))for(const u of a)ke(i,u,{descendArray:!0});return i}function wt(e,t){const r=[!1,!1];for(const[n,s]of Object.entries(e)){if(n===(t==null?void 0:t.idKey))return;s===0||s===!1?r[0]=!0:(s===1||s===!0)&&(r[1]=!0),O(!(r[0]&&r[1]),"Projection cannot have a mix of inclusion and exclusion.")}}const St=(e,t,r)=>e.drop(t),Kr=(e,t,r,n)=>{const s=te(e,r),i=new T(t,n);O(s instanceof Array,"$elemMatch: argument must resolve to array");const o=[];for(let c=0;c<s.length;c++)if(i.test(s[c])){if(n.useStrictMode)return[s[c]];o.push(s[c])}return o.length>0?o:void 0},Br=(e,t,r,n)=>{const s=te(e,r),i=t;return m(s)?Dr(e,t instanceof Array?[s,...i]:[s,t],n):s},vt=Object.freeze(Object.defineProperty({__proto__:null,$elemMatch:Kr,$slice:Br},Symbol.toStringTag,{value:"Module"})),Jr=$(jr),Yr=$(mt),Hr=$(Nr),ue=e=>$((t,r,n)=>{let s=0;if(r instanceof Array)for(const i of r)s=s|1<<i;else s=r;return e(t&s,s)}),Qr=ue((e,t)=>e==0),Wr=ue((e,t)=>e==t),Xr=ue((e,t)=>e<t),Zr=ue((e,t)=>e>0),en=$(je),tn=$(pt),rn=$(yt),nn=$(ht),sn=$(dt),on=$(gt),cn=$(ft),an=$(Er),un=$(Ir),ln=$(Pr);function fn(e,t,r){return n=>y(n,t,null,r)}function hn(e,t,r){if(!(r!=null&&r.jsonSchemaValidator))throw new L("Missing option 'jsonSchemaValidator'. Configure to use '$jsonSchema' operator.");const n=r==null?void 0:r.jsonSchemaValidator(t);return s=>n(s)}const dn=$(Ar),gn=$(xr);function pn(e,t,r){O(r.scriptEnabled,"$where operator requires 'scriptEnabled' option to be true");const n=t;return O(Ae(n),"$where only accepts a Function object"),s=>z(n.call(s),r==null?void 0:r.useStrictMode)}const yn=(e,t,r)=>{O(m(t),"Invalid expression: $and expects value to be an Array.");const n=t.map(s=>new T(s,r));return s=>n.every(i=>i.test(s))},Et=(e,t,r)=>{O(m(t),"Invalid expression. $or expects value to be an Array");const n=t.map(s=>new T(s,r));return s=>n.some(i=>i.test(s))},mn=(e,t,r)=>{O(m(t),"Invalid expression. $nor expects value to be an array.");const n=Et("$or",t,r);return s=>!n(s)},On=(e,t,r)=>{const n={};n[e]=at(t);const s=new T(n,r);return i=>!s.test(i)},At=Object.freeze(Object.defineProperty({__proto__:null,$all:Jr,$and:yn,$bitsAllClear:Qr,$bitsAllSet:Wr,$bitsAnyClear:Xr,$bitsAnySet:Zr,$elemMatch:Yr,$eq:en,$exists:un,$expr:fn,$gt:tn,$gte:rn,$in:nn,$jsonSchema:hn,$lt:sn,$lte:on,$mod:dn,$ne:cn,$nin:an,$nor:mn,$not:On,$or:Et,$regex:gn,$size:Hr,$type:ln,$where:pn},Symbol.toStringTag,{value:"Module"}));ce(N.EXPRESSION,{...lt,...Ot});ce(N.PIPELINE,{$project:_t,$skip:St,$limit:bt,$sort:$t});ce(N.PROJECTION,vt);ce(N.QUERY,At);j.init().addExpressionOps({...lt,...Ot}).addPipelineOps({$project:_t,$skip:St,$limit:bt,$sort:$t}).addProjectionOps(vt).addQueryOps(At);function $n(e,t,r,n){return new T(t,n).find(e,r)}function bn(e,t,r){return new T(t,r).remove(e)}function _n(e,t,r){return new Ie(t,r).run(e)}var Ri={Aggregator:Ie,Query:T,aggregate:_n,find:$n,remove:bn},wn=typeof window=="object"&&window&&window.Object===Object&&window,Sn=wn,vn=Sn,En=typeof self=="object"&&self&&self.Object===Object&&self,An=vn||En||Function("return this")(),xn=An,In=xn,jn=In.Symbol,Ne=jn;function Nn(e,t){for(var r=-1,n=e==null?0:e.length,s=Array(n);++r<n;)s[r]=t(e[r],r,e);return s}var Tn=Nn,Mn=Array.isArray,Pn=Mn,Be=Ne,xt=Object.prototype,Rn=xt.hasOwnProperty,Cn=xt.toString,H=Be?Be.toStringTag:void 0;function kn(e){var t=Rn.call(e,H),r=e[H];try{e[H]=void 0;var n=!0}catch{}var s=Cn.call(e);return n&&(t?e[H]=r:delete e[H]),s}var Ln=kn,Fn=Object.prototype,Un=Fn.toString;function Gn(e){return Un.call(e)}var zn=Gn,Je=Ne,Dn=Ln,qn=zn,Vn="[object Null]",Kn="[object Undefined]",Ye=Je?Je.toStringTag:void 0;function Bn(e){return e==null?e===void 0?Kn:Vn:Ye&&Ye in Object(e)?Dn(e):qn(e)}var Jn=Bn;function Yn(e){return e!=null&&typeof e=="object"}var Hn=Yn,Qn=Jn,Wn=Hn,Xn="[object Symbol]";function Zn(e){return typeof e=="symbol"||Wn(e)&&Qn(e)==Xn}var es=Zn,He=Ne,ts=Tn,rs=Pn,ns=es,ss=1/0,Qe=He?He.prototype:void 0,We=Qe?Qe.toString:void 0;function It(e){if(typeof e=="string")return e;if(rs(e))return ts(e,It)+"";if(ns(e))return We?We.call(e):"";var t=e+"";return t=="0"&&1/e==-ss?"-0":t}var jt=It,is=/\s/;function os(e){for(var t=e.length;t--&&is.test(e.charAt(t)););return t}var cs=os,as=cs,us=/^\s+/;function ls(e){return e&&e.slice(0,as(e)+1).replace(us,"")}var fs=ls;function hs(e,t,r){var n=-1,s=e.length;t<0&&(t=-t>s?0:s+t),r=r>s?s:r,r<0&&(r+=s),s=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(s);++n<s;)i[n]=e[n+t];return i}var ds=hs,gs=ds;function ps(e,t,r){var n=e.length;return r=r===void 0?n:r,!t&&r>=n?e:gs(e,t,r)}var ys=ps;function ms(e,t,r,n){for(var s=e.length,i=r+(n?1:-1);n?i--:++i<s;)if(t(e[i],i,e))return i;return-1}var Os=ms;function $s(e){return e!==e}var bs=$s;function _s(e,t,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===t)return n;return-1}var ws=_s,Ss=Os,vs=bs,Es=ws;function As(e,t,r){return t===t?Es(e,t,r):Ss(e,vs,r)}var Nt=As,xs=Nt;function Is(e,t){for(var r=e.length;r--&&xs(t,e[r],0)>-1;);return r}var js=Is,Ns=Nt;function Ts(e,t){for(var r=-1,n=e.length;++r<n&&Ns(t,e[r],0)>-1;);return r}var Ms=Ts;function Ps(e){return e.split("")}var Rs=Ps,Cs="\\ud800-\\udfff",ks="\\u0300-\\u036f",Ls="\\ufe20-\\ufe2f",Fs="\\u20d0-\\u20ff",Us=ks+Ls+Fs,Gs="\\ufe0e\\ufe0f",zs="\\u200d",Ds=RegExp("["+zs+Cs+Us+Gs+"]");function qs(e){return Ds.test(e)}var Vs=qs,Tt="\\ud800-\\udfff",Ks="\\u0300-\\u036f",Bs="\\ufe20-\\ufe2f",Js="\\u20d0-\\u20ff",Ys=Ks+Bs+Js,Hs="\\ufe0e\\ufe0f",Qs="["+Tt+"]",Se="["+Ys+"]",ve="\\ud83c[\\udffb-\\udfff]",Ws="(?:"+Se+"|"+ve+")",Mt="[^"+Tt+"]",Pt="(?:\\ud83c[\\udde6-\\uddff]){2}",Rt="[\\ud800-\\udbff][\\udc00-\\udfff]",Xs="\\u200d",Ct=Ws+"?",kt="["+Hs+"]?",Zs="(?:"+Xs+"(?:"+[Mt,Pt,Rt].join("|")+")"+kt+Ct+")*",ei=kt+Ct+Zs,ti="(?:"+[Mt+Se+"?",Se,Pt,Rt,Qs].join("|")+")",ri=RegExp(ve+"(?="+ve+")|"+ti+ei,"g");function ni(e){return e.match(ri)||[]}var si=ni,ii=Rs,oi=Vs,ci=si;function ai(e){return oi(e)?ci(e):ii(e)}var ui=ai,li=jt;function fi(e){return e==null?"":li(e)}var hi=fi,di=jt,gi=fs,pi=ys,yi=js,mi=Ms,Xe=ui,Oi=hi;function $i(e,t,r){if(e=Oi(e),e&&(r||t===void 0))return gi(e);if(!e||!(t=di(t)))return e;var n=Xe(e),s=Xe(t),i=mi(n,s),o=yi(n,s)+1;return pi(n,i,o).join("")}var bi=$i,de=bi;function _i(e){e=de(e);for(var t=/(\w+:|-)?("[^"]*"|'[^']*'|[^\s]+)/g,r=[],n;n=t.exec(e);){var s=n[1],i=n[2],o={};/^".+"$/.test(i)&&(i=de(i,'" '),o.phrase=!0),/^'.+'$/.test(i)&&(i=de(i,"' "),o.phrase=!0),o.term=i,s&&(s=="-"?o.exclude=!0:o.tag=s.slice(0,-1)),r.push(o)}return r}var wi=_i,Si=wi;const Ci=Ee(Si);/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */var vi=function(t){return typeof t<"u"&&t!==null&&(typeof t=="object"||typeof t=="function")},Ze=vi,Ei=function(t){Ze(t)||(t={});for(var r=arguments.length,n=1;n<r;n++){var s=arguments[n];Ze(s)&&Ai(t,s)}return t};function Ai(e,t){for(var r in t)xi(t,r)&&(e[r]=t[r])}function xi(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Ii=Ei,ge={},et,C={default:{"&quot;":'"',"&#34;":'"',"&apos;":"'","&#39;":"'","&amp;":"&","&#38;":"&","&gt;":">","&#62;":">","&lt;":"<","&#60;":"<"},extras:{"&cent;":"¢","&#162;":"¢","&copy;":"©","&#169;":"©","&euro;":"€","&#8364;":"€","&pound;":"£","&#163;":"£","&reg;":"®","&#174;":"®","&yen;":"¥","&#165;":"¥"}};Object.defineProperty(C,"all",{get:function(){return et||(et=Ii({},C.default,C.extras))}});function le(e,t){if(!Ni(e))return"";var r=C[t||"default"],n=ji(t,r);return e.replace(n,function(s){return r[s]})}function ji(e,t){if(ge[e])return ge[e];var r=Object.keys(t).join("|"),n=new RegExp("(?=("+r+"))\\1","g");return ge[e]=n,n}function Ni(e){return e&&typeof e=="string"}le.chars=C.default;le.extras=C.extras;Object.defineProperty(le,"all",{get:function(){return C.all}});var Ti=le;const ki=Ee(Ti);export{Pi as m,Ri as s,Ci as t,ki as u};
